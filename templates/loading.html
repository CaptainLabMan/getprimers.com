{% extends 'clear_base.html' %}

{% block title %}
  {{ gene }} | GP Results
{% endblock %}


{% block main_block %}
<form name='results_table_form' id='results_table_form' action="/results_table" method="post" target="_blank" hidden>
  <input type="text" name='gp_request_id' id="gp_request_id" value="{{ gp_request_id }}">
</form>
<div id="dna_loading" class='text-center w-100' style='ackground: url(https://svgshare.com/i/cup.svg);'>
<br>

  <div class="container">
    <div class="row">
      <div class="col-lg-4 col-md-0">
      </div>
      <div class="col-lg-4 col-md-12">
        <div class="bg-white shadow border p-3 text-center" style='border-radius: 15px; display: inline-block; ertical-align: top; width: 450px;'>
          <h2 class="text-dark mb-2">Please wait</h2>
          <div class="" id='statuses_place'>
            <p class="mb-1">Starting...</p>
            {% for _ in range(1, 20) %}
              <br class="mb-1">
            {% endfor %}
          </div>
            <div class="">
              <p class="mt-3 m-0 p-0">Expected waiting time - {{ primers_design_time_counter['primers_design_time'] }} min.</p>
              <p class="mt-2 m-0 p-0">Max waiting time - {{ primers_design_time_counter['max_primers_design_time'] }} min.</p>
            </div>
            <div id='server_status'>
            </div>
        </div>
      </div>
      <div class="col-lg-4 col-md-0">
      </div>
    </div>
  </div>
<div class="d-lg-block d-none">
  <br><br><br>
</div>
<div class="d-lg-none d-block">
  <br><br><br><br>
</div>
</div>

<div id="results_here">
</div>

<script>
            function get_results() {
                var gp_request_id=document.getElementById("gp_request_id").value;
                $.ajax({
                    type: "POST",
                    url: "/ajax_results",
                    data: JSON.stringify({gp_request_id: gp_request_id}),
                    contentType: "application/json; charset=UTF-8",
                    success: function(response) {
                        $('#results_here').html(response)
                        console.log(response);
                    },
                    error: function(error) {
                        console.log(error);
                    }
                });
                  $.ajax({
                      type: "POST",
                      url: "/statuses",
                      data: JSON.stringify({gp_request_id: gp_request_id}),
                      contentType: "application/json; charset=UTF-8",
                      success: function(response) {
                          $('#statuses_place').html(response)
                          console.log(response);
                      },
                      error: function(error) {
                          console.log(error);
                      }
                  });
              }
            window.onload = get_results;
</script>

{% endblock %}
